//nolint
syntax = "proto3";

package proto;
option go_package = "main/proto";

// Java Configuration
option java_multiple_files = true;
option java_outer_classname = "EV3Client";

// Functions that can be called through the interface
service Motors {
  rpc RunMotors(MultipleMotors) returns (StatusReply) {} // Takes an array. Usable for all amounts of motors at a time
  rpc StopMotors(MultipleMotors) returns (StatusReply) {}
  rpc Drive(DriveRequest) returns (StatusReply) {}
  rpc Rotate(RotateRequest) returns (StatusReply) {}
  rpc Grab(GrabRequest) returns (StatusReply) {}
}

// Motortypes
enum Type {
  l = 0;
  m = 1;
  s = 2; // For possible future needs - not used
}

// Ports on EV3
enum Port {
  A = 0;
  B = 1;
  C = 2;
  D = 3;
}

// MultipleMotors reuses the message MotorRequest
// The 'repeated' keyword makes it an array of motors, which can be handled with standard array syntax
// Note that '1' is a tag, as the default value of repeated fields is empty
message MotorRequest {
  int32 motorSpeed = 1;
  Type motorType = 2; // E.g. "medium"
  Port motorPort = 3; // E.g. "A"
}

message RotateRequest {
  repeated MotorRequest motors = 1;
  int32 degrees = 2;
  int32 speed = 3;
}

message DriveRequest {
  repeated MotorRequest motors = 1;
  float distance = 2;
  int32 speed = 3;
}

message GrabRequest {
  MotorRequest motor = 1;
  float degreesOfRotation = 2;
  int32 speed = 3;
}

message StatusReply {
  bool replyMessage = 1; // Success
}

// Might need to out-phased at some point
message MultipleMotors {
  repeated MotorRequest motor = 1;
}